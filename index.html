<!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" crossorigin="anonymous"></script>
        <title>Sahbes</title>
        <style>
            * {
                margin: 0;
                padding: 0;
            }

            #menu {
                position: absolute;
                max-height: 60%;
                overflow-y: auto;
                left: 10%;
                top: 20%;
                align-items: center;
                border-radius: 2.5px;
                box-shadow: 0 0 15px black;
            }

            .item {
                position: relative;
                width: 350px;
                text-align: center;
            }

            .item:first-child {
                background-color: blue;
                color: white;
            }

            .item span {
                display: block;
                padding: 22.5px 0;
                font-size: 40px;
                font-weight: bold;
            }
        </style>
        <script>
            let menu_data = {
                resource: "NOT INITIALIZED",
                clientID: 123456789,
                current_page: "Sahbes",
                current_selection: 1,
                menu_style: "default",
                menu: [
                    {
                        title: "Sahbes",
                        parent: "close",
                        options: [
                            {
                                name: "Not Initialized",
                                action: {type: "print", message: "Not Initialized"}
                            }
                        ]
                    }
                ]
            }

            function ActionButton(data) {
                if (data.type == "page") {
                    ChangePage(data.page);
                } else if (data.type == "print") {
                    console.log(data.message);
                }
            }

            $(window).on('message', function($event) {
                if (event.data.action == "initialize") {
                    menu_data = event.data.data
                    ChangePage(menu_data.current_page)
                } else if (event.data.action == "input") {
                    if (event.data.data == "back") {
                        for (let i = 0; i < menu_data.menu.length; i++) {
                            if (menu_data.menu[i].title == menu_data.current_page) {
                                ChangePage(menu_data.menu[i].parent)
                                break;
                            }
                        }
                    } else if (event.data.data == "enter") {
                        for (let i = 0; i < menu_data.menu.length; i++) {
                            if (menu_data.menu[i].title == menu_data.current_page) {
                                ActionButton(menu_data.menu[i].options[menu_data.current_selection - 1].action)
                                break;
                            }
                        }
                    } else if (event.data.data == "up") {
                        menu_data.current_selection++;
                        ChangePage(menu_data.current_page);
                    } else if (event.data.data == "down") {
                        menu_data.current_selection--;
                        ChangePage(menu_data.current_page);
                    }
                }
            });

            function ChangePage(newPage) {
                menu_data.current_selection = 1;

                if (newPage == "close") {
                    $.post("https://"+menu_data.resource+"/close", JSON.stringify({}));
                    return;
                }

                for (let i = 0; i < menu_data.menu.length; i++) {
                  if (menu_data.menu[i].title == newPage) {
                      menu_data.current_page = newPage;

                      let container = document.getElementById("menu");
                      container.innerHTML = "";

                      let title = document.createElement("div");
                      title.classList.add("item");

                      let title_span = document.createElement("span");
                      title_span.innerHTML = menu_data.current_page;

                      title.appendChild(title_span);
                      container.appendChild(title);

                      for (let j = 0; j < menu_data.menu[i].options.length; j++) {
                          let div = document.createElement("div");
                          div.classList.add("item");

                          if (menu_data.current_selection - 1 == j) {
                              div.classList.add("selected");
                          }

                          let span = document.createElement("span");
                          span.innerHTML = menu_data.menu[i].options[j].name;

                          div.addEventListener("click", function() { ActionButton(option.action) });

                          div.appendChild(span);
                          container.appendChild(div);
                      }

                      break;
                  }
                }
            }

            function ChangeStyle(style) {
                $.post("https://duiRepro/ready", JSON.stringify({}));
            }
        </script>
    </head>
    <body>
        <div id="menu">
            <div class="item">
                <span>Sahbes</span>
            </div>
        </div>
    </body>
</html>